<?php
class HFReversibleEncrypt{
	private static $xorkeys = array(173,96,269,161,341,425,425,120,168,198,251,246,125,158,176,200,228,
           178,24,193,200,177,47,81,207,155,122,77,5,182,249,254,141,108,233,
           187,251,63,241,33,115,151,2,166,19,239,104,212,110,232,87,175,235,
           31,125,196,31,187,218,255,74,173,74,24,79,22,157,92,132,91,50,97,
           142,3,50,7,165,238,41,114,76,122,141,121,189,193,127,60,176,217,232,
           149,5,179,116,127,174,190,13,246,102,109,18,85,48,54,112,196,244,116,
           174,209,32,150,0,173,57,57,252,49,62,145,60,46,45,9,165,92,168,211,
           137,240,210,154,199,46,36,153,14,106,29,111,166,69,60,243,207,77,216,
           55,39,18,92,196,100,109,5,189,156,208,42,31,166,70,200,223,110,150,47,
           118,46,89,41,216,70,87,156,30,136,86,139,79,76,65,141,23,109,214,107,
           24,140,171,61,151,233,150,152,234,80,104,149,82,214,248,116,179,178,
           56,164,124,78,16,189,202,38,148,88,38,146,253,176,6,232,27,27,203,172,
           168,41,250,76,247,130,216,15,126,117,210,8,142,133,25,194,166,34,10,
           34,107,93,43,10,209,81,93,123);
    
    /**
     * 十六进制 转 ASCII
     * 
     * @param string $name 字符串
     */
	private static function hex2asc($str) {
		$data = '';
		$len = strlen($str);
		for ($i=0; $i<$len; $i+=2) $data .= chr(hexdec(substr($str, $i, 2)));
		return $data;
	}
    /**
     * 加密文件名
     * 
     * @param string $name 文件名
     */
	public static function encrypt($name){
        $name = strval($name);
		$result="";
		for($i=0; $i<strlen($name); $i++){
			$result .= chr(ord($name[$i]) ^ self::$xorkeys[$i]);
		}
		return strtoupper(bin2hex($result));
	}
    /**
     * 解密文件名
     * 
     * @param string $name 文件名
     */
	public static function decrypt($name){
        $name = strval($name);
		$s = self::hex2asc($name);
		$result="";
		for($i=0; $i<strlen($s); $i++){
			$result .= chr(ord($s[$i]) ^ self::$xorkeys[$i]);
		}
		return $result;
	}
}